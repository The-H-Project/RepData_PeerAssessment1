---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data
This assignment was prepared using:  
* R version 3.2.3  
* data.table version 1.9.6

data.table is used to load the activity.csv dataset and:  
1. pad the interval data with zeroes we can convert it to time data (**Interval_f** = formatted interval)  
2. convert the date column to **date** data  
3. create a continuous date/time series with the date and time data (**Interval_dt**)  


```{r}
library(data.table)
dataset <- data.table(fread('activity.csv', na.strings='NA'))
dataset[,Interval_f := sprintf("%04d", as.numeric(interval))]
dataset[,date := as.Date(date, format='%Y-%m-%d')] 
dataset[,Interval_dt := as.POSIXct(paste(date,Interval_f), format='%Y-%m-%d %H%M')]  
```

## What is mean total number of steps taken per day?

data.table is used to create summary table 'totalset' that contains the total number steps per day. The 'totalset' table is then plotted using the hist function.

```{r}
totalset <- dataset[,sum(steps), by=date]
names(totalset)[2] <- 'TotalSteps'
mediansteps <- median(totalset$TotalSteps, na.rm = TRUE)
meansteps <- mean(totalset$TotalSteps, na.rm = TRUE)

hist(totalset$TotalSteps, main='Number of Steps Taken Per Day', xlab='Steps Taken Per Day',
     ylab='Number of Days (Frequency)', breaks=length(unique(totalset$TotalSteps)))  
```

The mean number of steps taken per day is: `r prettyNum(meansteps, big.mark=',')`

The median number of steps taken per day is: `r prettyNum(mediansteps, big.mark=',')`

## What is the average daily activity pattern?

data.table is used to create summary table 'averageset', which contains the average number of steps per time interval across all days. The 'averageset' table is then plotted in time series plot.

Also, determine the interval that had the highest average number of steps.
```{r}
averageset <- dataset[,mean(steps, na.rm = TRUE), by=Interval_f]
names(averageset)[2] <- 'AverageSteps'

plot(x=averageset$Interval_f,y = averageset$AverageSteps, main='Average Daily Pattern',
     xlab = 'Time', ylab='Average Number of Steps', type='l')

whichinterval <- averageset[which.max(AverageSteps),Interval_f]
```

The 5-minute interval that on average contains the maximum number of steps: **`r whichinterval`**

## Imputing missing values

data.table is used to cast (widen and shorten) the data table by forcing each date to its own row, and the intervals to columns. (This is equivalent to creating a pivot table in Microsoft Excel, using Date as Row value Interval_f as the Column value, and steps as the data)

From this table (datawide), we are able to determine that there are 

We're going to impute missing data values by figuring out the average steps per interval per day. 

```{r}
datawide <- dcast.data.table(dataset, date ~ Interval_f, value.var = 'steps')

# Figure out the weekday number of each date.
datawide[,day := as.factor(format.Date(date, format='%w'))]

# Figure out the average values per interval on each given day. Remove the date column from this table because it's not an averaged value. We're going to use this data to replace missing values based on weekday value.
dayaverages <- datawide[, lapply(.SD, mean, na.rm=TRUE), by=day]
dayaverages[,date := NULL]

```

## Are there differences in activity patterns between weekdays and weekends?
